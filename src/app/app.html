<mat-toolbar color="primary" class="app-toolbar" role="navigation">
  @if (showAdminNav()) {
  <button
    mat-icon-button
    type="button"
    class="nav-toggle"
    aria-label="Toggle menu"
    (click)="toggleNav()"
  >
    <mat-icon>menu</mat-icon>
  </button>
  }
  <a class="brand-logo" routerLink="/">
    <img src="assets/ilan-logo.svg" alt="ILAN Foods" />
  </a>
  <div class="global-search">
    <div class="search-shell">
      <mat-icon>search</mat-icon>
      <input
        type="search"
        placeholder="Search products, brands, categories"
        [ngModel]="searchTerm()"
        (ngModelChange)="onSearchInput($event)"
        (keyup.enter)="submitSearch()"
      />
      <button mat-icon-button type="button" aria-label="Submit search" (click)="submitSearch()">
        <mat-icon>arrow_forward</mat-icon>
      </button>
    </div>
    @if (showSuggestions()) {
    <div class="search-dropdown">
      @for (s of suggestions(); track s.slug) {
      <button type="button" class="search-item" (click)="goToSuggestion(s)">
        <div class="title">{{ s.name }}</div>
        <div class="meta">{{ s.brand }} Â· {{ s.category }}</div>
      </button>
      }
      @if (!suggestions().length) { <div class="search-empty">No matches</div> }
    </div>
    }
  </div>
  <span class="spacer"></span>
  <a
    mat-button
    routerLink="/"
    routerLinkActive="active-link"
    [routerLinkActiveOptions]="{ exact: true }"
    >Catalog</a
  >
  <a
    mat-icon-button
    routerLink="/quote"
    routerLinkActive="active-link"
    class="icon-link"
    aria-label="Quote cart"
  >
    <mat-icon>shopping_cart</mat-icon>
    @if (quoteCount() > 0) { <span class="count-badge">{{ quoteCount() }}</span> }
  </a>
  @if (user()) {
  <a mat-button routerLink="/admin" routerLinkActive="active-link">Admin</a>
  } @if (user()) {
  <button
    mat-icon-button
    class="user-menu-trigger"
    [matMenuTriggerFor]="userMenu"
    aria-label="User menu"
  >
    <mat-icon>account_circle</mat-icon>
  </button>
  <mat-menu #userMenu="matMenu">
    <button mat-menu-item disabled>
      <mat-icon>person</mat-icon>
      <span>{{ user()?.email }}</span>
    </button>
    <button mat-menu-item (click)="logout()">
      <mat-icon>logout</mat-icon>
      <span>Logout</span>
    </button>
  </mat-menu>
  } @else {
  <a mat-button routerLink="/login" routerLinkActive="active-link">Login</a>
  }
  <button
    mat-icon-button
    type="button"
    class="theme-toggle"
    [attr.aria-label]="theme() === 'light' ? 'Switch to dark mode' : 'Switch to light mode'"
    (click)="toggleTheme()"
  >
    <mat-icon>{{ theme() === 'light' ? 'dark_mode' : 'light_mode' }}</mat-icon>
  </button>
</mat-toolbar>

<main class="app-content">
  <div class="content-container">
    <app-breadcrumbs />
    <router-outlet></router-outlet>
  </div>
</main>

<footer class="app-footer">
  <div>Product Catalog &amp; Quotes</div>
  <div class="footer-links">
    <a routerLink="/">Home</a>
    @if (user()) {
    <a routerLink="/admin">Admin</a>
    }
  </div>
</footer>
