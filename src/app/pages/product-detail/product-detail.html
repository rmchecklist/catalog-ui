@if (product(); as p) {
  <div class="detail-card">
    <div class="detail-layout">
      @if (p.imageUrl) {
        <div class="media">
          <img [src]="p.imageUrl" [alt]="p.name" loading="lazy" />
        </div>
      }
      <div class="content" [class.full-width]="!p.imageUrl">
        <p class="eyebrow">{{ p.brand }} Â· {{ p.category }}</p>
        <h1>{{ p.name }}</h1>
        <p class="lede">{{ p.description }}</p>
        <div class="options">
          @for (option of p.options; track option.label) {
            <div class="option-row" [class.unavailable]="option.available === false">
              <div class="option-line">
                <span class="option-label">{{ option.label }}</span>
                @if (option.weight) { <span class="option-meta">Weight: {{ option.weight }}</span> }
                @if (option.minQty) { <span class="option-meta">Min qty: {{ option.minQty }}</span> }
                @if (option.available === false) { <span class="option-meta">Unavailable</span> }
              </div>
              <div class="qty">
                <label>
                  Qty
                  <input
                    type="number"
                    [min]="option.minQty ?? 1"
                    step="1"
                    [value]="quantities()[option.label] || option.minQty || 1"
                    (input)="updateQuantity(option.label, $any($event.target).value)"
                    [disabled]="option.available === false"
                  />
                </label>
              </div>
              <button
                class="icon-btn add"
                type="button"
                [disabled]="option.available === false || isInCart(option.label)"
                (click)="addSingleOption(option.label)"
                [title]="isInCart(option.label) ? 'Already added' : 'Add to quote'"
              >
                <svg aria-hidden="true" viewBox="0 0 24 24" class="cart-icon">
                  <path
                    d="M7 4h-2l-1 2h-2v2h2l3.6 7.59-1.35 2.44c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2h-11.42c-.14 0-.25-.11-.25-.25 0-.04.01-.08.03-.11l.9-1.64h7.74c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1h-14.31l-.94-2zm2 16c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"
                  />
                </svg>
              </button>
            </div>
          }
        </div>
        <div class="actions">
          <a class="btn ghost" routerLink="/">Back to catalog</a>
        </div>
      </div>
    </div>
  </div>
} @else {
  <div class="detail-card">
    <h1>Product not found</h1>
    <p class="lede">Try returning to the catalog.</p>
    <a class="btn ghost" routerLink="/">Back to catalog</a>
  </div>
}
